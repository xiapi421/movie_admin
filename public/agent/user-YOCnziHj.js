import{R as f,S as g,r,T as m}from"./index-C7PasKrt.js";import{f as I,l as p}from"./agent-CVzn-QVZ.js";const S=async(n,o)=>{try{return(await f("/user/login",{username:n,password:o})).data}catch(t){throw console.error("登录失败:",t),t}},y=g("user",()=>{const n=r("后台登录"),o=r(null),t=r("");async function l(e,i){var s;const a=await S(e,i);return a.code===1&&(o.value=a.data.userInfo,localStorage.setItem("token",((s=o.value)==null?void 0:s.token)||""),localStorage.setItem("userInfo",JSON.stringify(o.value))),a}async function u(){const e=await I();e.code===1&&(n.value=e.data.site_name)}async function c(){o.value=null,localStorage.removeItem("token"),await p();const e=localStorage.getItem("loginUrl")||"/";m.push(e)}return{site_name:n,userInfo:o,loginUrl:t,login:l,logout:c,getInfos:u}});export{y as u};
