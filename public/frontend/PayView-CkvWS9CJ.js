import{r as t,u as e,a,z as s,b as o,e as d,i as r,f as n,h as c,t as i,F as p,m as l}from"./index-EC6x3pdd.js";import{_ as h,u}from"./configStore-CZklP0XV.js";const m={id:"topyd"},g={key:0,src:"https://cloud.hzhph.com/frontend/android-s7z0E8aQ.jpg"},y={key:1,src:"https://cloud.hzhph.com/frontend/ios-BKABQp9S.jpg"},v={id:"centeryd"},f={key:0,src:"https://cloud.hzhph.com/frontend/androidydt-BaMkv61f.jpg"},b={key:1,src:"https://cloud.hzhph.com/frontend/iosydt-DPit3BcZ.jpg"},j={id:"bottomyd"},z={style:{color:"green"}},k=h({__name:"PayView",setup(h){const k=o();u(),t("/android.jpg");const x=/iPhone/i.test(navigator.userAgent),I=/Android/i.test(navigator.userAgent),w=e(),A=w.params.tradeno,S=w.params.payurl,_=t("正在查询");let B=null;sessionStorage.getItem("ic"),a((()=>{const t=/MicroMessenger/i.test(navigator.userAgent);if(t&&I){const t="https://cloud.hzhph.com/index.php/api/index/androidCheat/pay/"+btoa(S),e=document.createElement("a");e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}t||(window.location.href=S),C(),B=setInterval(C,5e3)})),s((()=>{B&&(clearInterval(B),B=null)}));const C=async()=>{try{const t=await fetch(`https://cloud.hzhph.com/index.php/api/index/checkOrderStatus?tradeno=${A}`),e=await t.json();1===e.code&&(_.value=1===e.data.status?"支付成功":"等待平台确认支付",1!==e.data.status&&3!==e.data.status||(clearInterval(B),M())),0===e.code&&(_.value=e.msg)}catch(t){_.value="查询失败，请稍后再试"}},M=()=>{k.push({path:"/home/"+localStorage.getItem("ic"),query:{tab:"purchased",refresh:"true"}})};return(t,e)=>(l(),d(p,null,[r("div",m,[c(x)?n("",!0):(l(),d("img",g)),c(x)?(l(),d("img",y)):n("",!0)]),r("div",v,[c(x)?n("",!0):(l(),d("img",f)),c(x)?(l(),d("img",b)):n("",!0)]),r("div",j,[e[0]||(e[0]=r("p",{style:{color:"red"}},"请不要后退页面-订单完成后会自动跳转",-1)),e[1]||(e[1]=r("p",{style:{color:"red"}},"正在获取订单状态:",-1)),r("p",z,i(_.value),1),e[2]||(e[2]=r("div",{class:"loading-dots"},[r("span",{class:"dot"}),r("span",{class:"dot"}),r("span",{class:"dot"})],-1))])],64))}},[["__scopeId","data-v-beb0cc32"]]);export{k as default};
