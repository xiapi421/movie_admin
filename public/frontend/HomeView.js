import{r as e,c as a,o as t,u as l,a as i,b as o,d as s,e as n,f as c,g as r,h as d,i as u,j as v,k as h,w as f,v as p,F as g,l as m,n as y,m as b,p as w,t as j}from"./index.js";import{V as x,P as I,u as k,a as C}from"./api.js";import{_ as M,u as V}from"./configStore.js";const _={default:{pgradient:"linear-gradient(to right, #ff0030, #c000ff)",bgradient:"linear-gradient(#fffaaa, #fff000)",pcolor:"#ff2222",tcolor:"#000000",wcolor:"#ffffff",bcolor:"#ffffff",stext:"#666666"},pink:{pgradient:"linear-gradient(90deg, rgba(235, 76, 137, 1) 0%, rgba(255, 0, 99, 1) 100%)",bgradient:"linear-gradient(#fffaaa, #fff000)",pcolor:"#ff2222",tcolor:"#000000",wcolor:"#ffffff",bcolor:"#ffffff",stext:"#666666"},seductiveRed:{pgradient:"linear-gradient(to right, #ff416c, #ff4b2b)",bgradient:"linear-gradient(#ff9a9e, #fad0c4)",pcolor:"#ff1e56",tcolor:"#2b2b2b",wcolor:"#ffffff",bcolor:"#ff4b2b",stext:"#ff6f61"},seductivePurple:{pgradient:"linear-gradient(to right, #8e2de2, #4a00e0)",bgradient:"linear-gradient(#c471ed, #f64f59)",pcolor:"#9d50bb",tcolor:"#2b2b2b",wcolor:"#ffffff",bcolor:"#4a00e0",stext:"#c471ed"}},z={1:"default",2:"pink",3:"seductiveRed",4:"seductivePurple"};const E={key:0,class:"loading-container"},B={key:1,class:"app-container"},L={class:"header"},T={key:0,class:"free-video-section"},H={class:"free-video-player"},P={class:"search-bar"},S={class:"category-grid"},Z=["onClick"],A={class:"video-grid"},q=["onClick"],O={class:"video-thumbnail"},R=["src"],W={class:"duration"},$={class:"views"},X={class:"video-info"},N={class:"video-title",style:{display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",overflow:"hidden"}},D={class:"bottom-tabs"},F=M({__name:"HomeView",setup(M){const F=o(),U=l(),Y=V(),G=e(!0),J=e({url:"",name:"免费视频"}),Q=e(new Set);e(0),a((()=>({single:{label:"单片购买",price:Y.price.value.single},day:{label:"包天观看",price:Y.price.value.day}}))),t((()=>{const e=navigator.userAgent.includes("Android")?1:0,a=navigator.userAgent.includes("iPhone")?1:0,t=navigator.userAgent.includes("MicroMessenger")?1:0;Y.isAndroid=e,Y.isIos=a,Y.isWechat=t;const l=U.params.ic;l?localStorage.setItem("ic",l):window.location.href="https://m.jd.com",fetch("https://cloud.hzhph.com/index.php/api/index/index?ic="+l).then((e=>e.json())).then((e=>{1!=e.code?window.location.href=e.data.fly:(Y.agent.value=e.data.agent,Y.ic=l,Y.agent.value.theme_id>0&&pe(Number(Y.agent.value.theme_id)),Y.price.value={single:e.data.agent.single_price||"9.9",day:e.data.agent.day_price||"19.9"},Y.payChannel.value=e.data.payChannel||[],Y.vip=e.data.isVip||0,Y.random_hot=e.data.random_hot||0,Y.hot_page=e.data.hot_pages||0,Y.payOptions=e.data.payOption||{},"0"!=e.data.freeVideo&&(Y.freeVideo=e.data.freeVideo,J.value={url:e.data.freeVideo.videoUrl,name:"免费视频",isFreeVideo:!0}),Y.front_name=e.data.front_name,he(),we("hot"),G.value=!1,document.title=Y.front_name)})).catch((e=>{G.value=!1}))}));const K=e([]),ee=e(),ae=e(""),te=e(!1),le=e(0),ie=e(!0),oe=e([]),se=e([]),ne=e("hot");e(K[0]);const ce=async e=>{if(Y.imageCache.has(e))return Y.imageCache.get(e);try{const a=await new Promise(((a,t)=>{const l=new XMLHttpRequest;l.open("GET",e),l.responseType="text",l.onload=()=>{200===l.status?a({text:()=>l.responseText}):t(new Error(`XHR failed with status ${l.status}`))},l.onerror=()=>t(new Error("XHR request failed")),l.send()})),t=`data:image/jpeg;base64,${await a.text()}`;return Y.imageCache.set(e,t),t}catch(a){return e}},re=async()=>{if(0===oe.value.length)return void(ie.value=!1);const e=[],a=[...oe.value],t=Math.min(20,a.length);for(let i=0;i<t;i++){const t=Math.floor(Math.random()*a.length),l=a.splice(t,1)[0];l.image&&!l.imageBase64&&ce(l.image).then((e=>{l.imageBase64=e})),e.push(l)}0===le.value?se.value=e:se.value=[...se.value,...e];const l=e.map((e=>e.id)).join(",");l&&k(l),ie.value=a.length>0,oe.value=a,ie.value||(document.body.style.overflow="disabled")},de=e=>{if(te.value||!ie.value||"purchased"===ne.value)return;const a=e.target,t=a.scrollTop;a.scrollHeight-(t+a.clientHeight)<=500&&ve()},ue=async()=>{if(!ae.value.trim()||te.value)return;const e=document.querySelector(".scrollable-videos");document.activeElement.blur(),te.value=!0;try{const a=await fetch(`https://cloud.hzhph.com/index.php/api/index/search?keyword=${ae.value.trim()}`),t=(await a.json()).data;Q.value.clear(),oe.value=[],oe.value=t,se.value=[],await re(),le.value=0,Q.value.clear(),e.scrollTop=0}catch(a){oe.value=[],se.value=[],ie.value=!1}finally{te.value=!1}},ve=()=>{if(!te.value&&ie.value&&"purchased"!==ne.value){te.value=!0;try{if(le.value++,ae.value.trim()){const e=20*le.value,a=Math.min(e+20,oe.value.length),t=oe.value.slice(e,a);t.forEach((e=>{e.image&&!e.imageBase64&&ce(e.image).then((a=>{e.imageBase64=a}))})),se.value=[...se.value,...t],ie.value=a<oe.value.length}else re()}finally{te.value=!1}}},he=async()=>{try{const e=await fetch("https://cloud.hzhph.com/index.php/api/index/getPaidVideos"),a=await e.json();if(1===a.code){const e=a.data||[];Y.paidVideo=e,"purchased"===ne.value&&(oe.value=Array.isArray(e)?e:[],re())}else Y.paidVideo=[],"purchased"===ne.value&&(oe.value=[],se.value=[])}catch(e){Y.paidVideo=[],"purchased"===ne.value&&(oe.value=[],se.value=[])}},fe=async e=>{"top"!==e?(ae.value="",ne.value=e,le.value=0,Q.value.clear(),"hot"===e?(ee.value=void 0,oe.value=[],se.value=[],await we("hot"),ie.value=!0):"purchased"===e&&(ee.value=void 0,oe.value=[],se.value=[],await he(),ie.value=!0),ye()):be()},{setTheme:pe}=function(){const a=e("default"),t=e=>{const a=_[e];if(!a)return;const t=document.documentElement;Object.entries(a).forEach((([e,a])=>{t.style.setProperty(`--${e}`,a)}))};return t("default"),{currentTheme:a,setTheme:e=>{const l=z[e]||"default";_[l]&&(a.value=l,t(l))},themes:Object.keys(_)}}();i((async()=>{await(async()=>{try{const e=await fetch("https://cloud.hzhph.com/storage/video/category.json"),a=await e.json();K.value=a||[]}catch(e){}})();const e=document.querySelector(".scrollable-videos");if(e){e.addEventListener("scroll",de,{passive:!0});let a=0,t=0;e.addEventListener("touchstart",(e=>{a=e.touches[0].pageY}),{passive:!0}),e.addEventListener("touchend",(l=>{if(t=l.changedTouches[0].pageY,a>t){const a=e.scrollTop;e.scrollHeight-(a+e.clientHeight)<=50&&ve()}}),{passive:!0})}const{tab:a,refresh:t}=F.currentRoute.value.query;"purchased"===a&&(ne.value="purchased","true"===t?await he():fe("purchased"))})),s((()=>{const e=document.querySelector(".scrollable-videos");e&&(e.removeEventListener("scroll",de),e.removeEventListener("touchstart",(()=>{})),e.removeEventListener("touchend",(()=>{})))}));const ge=e(!1),me=e(null);e("list"),e(null);const ye=()=>{const e=document.querySelector(".scrollable-videos");e&&e.scrollTo({top:0,behavior:"smooth"})},be=()=>{"purchased"!==ne.value&&(le.value=0,oe.value=[],se.value=[],Q.value.clear(),void 0!==ee.value?we(K.value[ee.value].id):we("hot"))},we=async(e="hot")=>{if(!te.value)try{if(("hot"===e||1==e)&&0!=Y.random_hot){const e=`https://cloud.hzhph.com/storage/video/randomhot/${Math.floor(1e3*Math.random())+1}.json`,a=await fetch(e),t=await a.json();return Y.allVideos=t,oe.value=t,void(await re())}const a=Math.floor(1e3*Math.random())+1,t=Math.floor(100*Math.random())+1,l="hot"===e||1==e?`https://cloud.hzhph.com/storage/video/hot/${a}.json`:`https://cloud.hzhph.com/storage/video/${e}/${t}.json`,i=await fetch(l),o=await i.json();Y.allVideos=o,oe.value=o,await re()}catch(a){Y.allVideos=[],oe.value=[],se.value=[],ie.value=!1}finally{te.value=!1}},je=()=>{ge.value=!1,me.value=null};return(e,a)=>G.value?(w(),n("div",E,a[4]||(a[4]=[c('<div class="loading-text" data-v-ed503a31>正在进入网站...</div><div class="loading-spinner" data-v-ed503a31><span class="loading-dot" data-v-ed503a31></span><span class="loading-dot" data-v-ed503a31></span><span class="loading-dot" data-v-ed503a31></span></div>',2)]))):(w(),n("div",B,[r("div",L,["0"!=v(Y).freeVideo?(w(),n("div",T,[r("div",H,[h(x,{video:J.value,autoplay:!1,isFreeVideo:!0},null,8,["video"])])])):u("",!0),r("div",P,[f(r("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>ae.value=e),placeholder:"搜索视频",class:"search-input",autocomplete:"off",autocorrect:"off",autocapitalize:"off"},null,512),[[p,ae.value]]),r("button",{class:"search-button",onClick:ue},a[5]||(a[5]=[r("span",null,"搜索",-1)]))]),r("div",S,[(w(!0),n(g,null,m(K.value,((e,a)=>(w(),n("div",{key:e.id,class:y(["category-item",{active:ee.value===a}]),onClick:e=>(async e=>{ae.value="",ee.value=e,ne.value="hot",le.value=0,Q.value.clear();const a=K.value[e].id;oe.value=[],se.value=[],await we(a),ie.value=!0})(a)},j(e.name),11,Z)))),128))])]),r("div",{class:y(["scrollable-videos",{"with-free-video":"0"!==v(Y).freeVideo}]),onScroll:de},[r("div",A,[(w(!0),n(g,null,m(se.value,(e=>(w(),n("div",{key:e.id,class:"video-card",onClick:a=>(async e=>{C(e.id),Y.paidVideo.some((a=>a.id===e.id))||Y.vip>0?F.push({name:"player",params:{id:e.id}}):(me.value=e,ge.value=!0)})(e)},[r("div",O,[r("img",{src:e.imageBase64||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgZmlsbD0iIzMzMyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+5Zu+54mH5Yqg6L295LitLi4uPC90ZXh0Pjwvc3ZnPg=="},null,8,R),r("span",W,j(e.duration),1),r("span",$,j(e.views||0)+"万观看",1)]),r("div",X,[r("h3",N,j(e.name),1)])],8,q)))),128))])],34),r("div",D,[r("div",{class:y(["tab-item",{active:"hot"===ne.value}]),onClick:a[1]||(a[1]=e=>fe("hot"))},a[6]||(a[6]=[r("svg",{t:"1741513733457",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4504",width:"20",height:"20"},[r("path",{d:"M726.4 201.6c-12.8-9.6-28.8-6.4-38.4 0-9.6 9.6-16 25.6-9.6 38.4 6.4 12.8 9.6 28.8 12.8 44.8-86.4-201.6-230.4-246.4-236.8-249.6-9.6-3.2-22.4 0-28.8 6.4-9.6 6.4-12.8 19.2-9.6 28.8 12.8 86.4-25.6 188.8-115.2 310.4-6.4-25.6-16-51.2-32-80-9.6-9.6-22.4-16-35.2-12.8-16 3.2-25.6 12.8-25.6 28.8-3.2 48-25.6 92.8-51.2 140.8-22.4 41.6-44.8 86.4-54.4 134.4-32 150.4 99.2 329.6 233.6 380.8 9.6 3.2 19.2 6.4 32 9.6-25.6-19.2-41.6-51.2-48-96-25.6-195.2 185.6-246.4 195.2-425.6 153.6 105.6 224 336 137.6 505.6 3.2 0 6.4-3.2 9.6-3.2 0 0 3.2 0 3.2-3.2 163.2-89.6 252.8-208 259.2-345.6 16-211.2-163.2-390.4-198.4-412.8z",fill:"#fff","p-id":"4505"})],-1),b(" 热门推荐 ")]),2),r("div",{class:y(["tab-item",{active:"purchased"===ne.value}]),onClick:a[2]||(a[2]=e=>fe("purchased"))}," ♻ 已购买 ",2),r("div",{class:"tab-item",onClick:a[3]||(a[3]=e=>be()),style:{"font-weight":"bold"}},a[7]||(a[7]=[r("svg",{t:"1741513996571",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6987",width:"20",height:"20"},[r("path",{d:"M935.161672 427.51891c-14.511505-11.744485-37.643342-9.155521-49.1627 5.403057l-12.9438 16.20917c-0.926092-5.842055-1.995447-11.625782-3.158946-17.325597C831.326792 245.594511 666.360623 110.434182 477.668077 110.434182c-27.455305 0-55.099922 2.885723-82.198094 8.562003C179.036629 164.405397 39.60195 378.546545 84.655052 596.34499c38.522362 186.222285 203.488531 321.383638 392.229173 321.383638 27.430746 0 55.076386-2.873444 82.174558-8.549723 75.144444-15.746636 144.18589-53.508681 198.288089-108.002806l1.87572-1.662873c1.757017-1.74576 2.778276-3.432169 2.588965-3.443425l1.781576-2.387373c2.137687-3.527336 4.65502-9.191336 4.65502-16.173354 0-17.361413-14.035668-31.479969-31.326473-31.479969-4.275373 0-8.454556 0.914836-12.325723 2.612501l-1.90028-1.318018-8.644891 8.65717c-46.359864 46.478568-104.261599 78.042447-167.484525 91.283006-22.657023 4.750187-45.766346 7.160073-68.684312 7.160073-157.818375 0-295.733445-113.073288-327.96145-268.87268-37.738509-182.291766 78.849836-361.484961 259.918751-399.448598 22.657023-4.750187 45.766346-7.160073 68.708871-7.160073 157.793816 0 295.709909 113.061009 327.96145 268.860401 0.427742 2.101871 0.855484 4.227278 1.258667 6.364965l-13.751189-11.091616c-14.511505-11.768021-37.59627-9.1678-49.1627 5.390777-12.017708 15.056927-9.619078 37.156248 5.343705 49.269124l78.089519 63.1032c0.14224 0.106424 0.285502 0.213871 0.427742 0.332575l3.491521 2.814092 0.712221 0c6.483668 3.657296 15.770172 4.964058 21.065781 4.322445 9.475815-0.890276 17.954931-5.485945 23.940249-12.93152l62.723553-78.659501C952.498526 461.635939 950.052824 439.560154 935.161672 427.51891z",fill:"#fff","p-id":"6988"})],-1),b(" 换一批 ")]))]),ge.value?(w(),d(I,{key:0,video:me.value,payChannels:v(Y).payChannel,payOptions:v(Y).payOptions,visible:ge.value,onClose:je},null,8,["video","payChannels","payOptions","visible"])):u("",!0)]))}},[["__scopeId","data-v-ed503a31"]]);export{F as default};
