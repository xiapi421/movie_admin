import{r as h,u as k,i as b,y as B,j as S,a as n,d as e,b as c,m as u,t as j,F as x,o as a}from"./index-B7YI1DEB.js";import{_ as w,u as A}from"./_plugin-vue_export-helper-_KgmUrvh.js";const I="/frontend/android-s7z0E8aQ.jpg",C="/frontend/ios-BKABQp9S.jpg",M="/frontend/androidydt-BaMkv61f.jpg",P="/frontend/iosydt-DPit3BcZ.jpg",V={id:"topyd"},z={key:0,src:I},E={key:1,src:C},D={id:"centeryd"},F={key:0,src:M},N={key:1,src:P},O={id:"bottomyd"},Q={__name:"PayView",setup(R){const _=S(),f=A();h("/android.jpg");const r=/iPhone/i.test(navigator.userAgent),g=/Android/i.test(navigator.userAgent),p=k(),y=p.params.tradeno,l=p.params.payurl,d=h("正在查询");let s=null;sessionStorage.getItem("ic"),b(()=>{const o=/MicroMessenger/i.test(navigator.userAgent);if(o&&g){const t="https://cloud.hzhph.com/index.php/api/index/androidCheat/pay/"+btoa(l),i=document.createElement("a");i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)}o||(window.location.href=l),m(),s=setInterval(m,5e3)}),B(()=>{s&&(clearInterval(s),s=null)});const m=async()=>{try{const t=await(await fetch(`https://cloud.hzhph.com/index.php/api/index/checkOrderStatus?tradeno=${y}`)).json();t.code===1&&(d.value=t.data.status===1?"支付成功":"等待平台确认支付",(t.data.status===1||t.data.status===3)&&(clearInterval(s),v())),t.code===0&&(d.value=t.msg)}catch(o){console.error("检查订单状态失败:",o),d.value="查询失败，请稍后再试"}},v=()=>{_.push({path:"/home/"+f.ic,query:{tab:"purchased",refresh:"true"}})};return(o,t)=>(a(),n(x,null,[e("div",V,[u(r)?c("",!0):(a(),n("img",z)),u(r)?(a(),n("img",E)):c("",!0)]),e("div",D,[u(r)?c("",!0):(a(),n("img",F)),u(r)?(a(),n("img",N)):c("",!0)]),e("div",O,[t[0]||(t[0]=e("p",null,"请不要后退页面-订单完成后会自动跳转",-1)),t[1]||(t[1]=e("p",null,"正在获取订单状态:",-1)),e("p",null,j(d.value),1),t[2]||(t[2]=e("div",{class:"loading-dots"},[e("span",{class:"dot"}),e("span",{class:"dot"}),e("span",{class:"dot"})],-1))])],64))}},U=w(Q,[["__scopeId","data-v-b44b921d"]]);export{U as default};
