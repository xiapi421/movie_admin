import{b as M,s as P}from"./agent-61WMLdmc.js";import{u as T}from"./user-BVO6oFcr.js";import{d as $,r,b as J,c as s,J as q,e as F,f as w,k as i,g as t,w as l,L as G,p as H,t as d,j as m,h as R,I as x}from"./index-qPmHQenT.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"p-4"},Q={class:"text-orange-500"},W={class:"text-orange-500"},X={class:"text-orange-500"},Y={class:"flex justify-end mt-4"},Z={class:"flex items-center gap-4"},ee={class:"text-gray-600 w-16"},te={class:"flex justify-end gap-2"},ae=$({__name:"UsersView",setup(le){const y=T(),C=r([]),g=r(!1),_=r(1),c=r(20),h=r(0),p=r(!1),v=r(null),u=r({subCommissionRate:50});async function f(){g.value=!0;try{const{data:o}=await M({current_page:_.value,per_page:c.value});console.log(o),C.value=o.data,h.value=o.total}catch{x.error("获取数据失败")}finally{g.value=!1}}function S(o){c.value=o,f()}function U(o){_.value=o,f()}function z(o){v.value=o,u.value.subCommissionRate=o.rate,p.value=!0}async function k(){if(v.value)try{await P({id:v.value.id,rate:u.value.subCommissionRate}),x.success("设置成功"),p.value=!1,f()}catch{x.error("设置失败")}}return J(()=>{f()}),(o,a)=>{const n=s("el-table-column"),V=s("el-tag"),b=s("el-button"),D=s("el-table"),I=s("el-pagination"),B=s("el-card"),j=s("el-slider"),N=s("el-form-item"),A=s("el-form"),E=s("el-dialog"),L=q("loading");return w(),F("div",O,[a[8]||(a[8]=i("h1",{class:"text-2xl font-bold mb-6 text-gray-800"},"用户管理",-1)),t(B,null,{default:l(()=>[G((w(),H(D,{data:C.value,border:"",stripe:""},{default:l(()=>[t(n,{prop:"id",label:"ID",width:"80",align:"center"}),t(n,{prop:"username",label:"用户名"}),t(n,{prop:"money",label:"余额",align:"right"},{default:l(({row:e})=>[i("span",Q," ¥"+d(e.money),1)]),_:1}),t(n,{prop:"today_sell",label:"今日销售额",align:"right"},{default:l(({row:e})=>[i("span",W," ¥"+d(e.today_sell),1)]),_:1}),t(n,{prop:"lastday_sell",label:"昨日销售额",align:"right"},{default:l(({row:e})=>[i("span",X," ¥"+d(e.lastday_sell),1)]),_:1}),t(n,{prop:"rate",label:"下级分润比例",align:"right"},{default:l(({row:e})=>[t(V,null,{default:l(()=>[m(d(e.rate)+"%",1)]),_:2},1024)]),_:1}),t(n,{prop:"commissionRate",label:"抽成比例",align:"right"},{default:l(({row:e})=>[t(V,null,{default:l(()=>[m(d(R(y).userInfo.rate-e.rate)+"%",1)]),_:2},1024)]),_:1}),t(n,{label:"操作",fixed:"right",align:"center"},{default:l(({row:e})=>[t(b,{type:"primary",size:"small",onClick:oe=>z(e)},{default:l(()=>a[5]||(a[5]=[m(" 设置分润 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,g.value]]),i("div",Y,[t(I,{"current-page":_.value,"onUpdate:currentPage":a[0]||(a[0]=e=>_.value=e),"page-size":c.value,"onUpdate:pageSize":a[1]||(a[1]=e=>c.value=e),total:h.value,"page-sizes":[20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:S,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1}),t(E,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),title:"设置分润比例",width:"500px"},{footer:l(()=>[i("div",te,[t(b,{onClick:a[3]||(a[3]=e=>p.value=!1)},{default:l(()=>a[6]||(a[6]=[m("取消")])),_:1}),t(b,{type:"primary",onClick:k},{default:l(()=>a[7]||(a[7]=[m("确认")])),_:1})])]),default:l(()=>[t(A,{ref:"formRef",model:u.value,"label-width":"100px"},{default:l(()=>[t(N,{label:"下级分润比例"},{default:l(()=>[i("div",Z,[t(j,{modelValue:u.value.subCommissionRate,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value.subCommissionRate=e),min:50,max:R(y).userInfo.rate,step:1,style:{width:"300px"}},null,8,["modelValue","max"]),i("span",ee,d(u.value.subCommissionRate)+"%",1)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ue=K(ae,[["__scopeId","data-v-68341123"]]);export{ue as default};
