import{M as g,N as f,r,O as m}from"./index-qPmHQenT.js";import{c as I,l as p}from"./agent-61WMLdmc.js";const d=async(n,o)=>{try{return(await g("/user/login",{username:n,password:o})).data}catch(t){throw console.error("登录失败:",t),t}},y=f("user",()=>{const n=r("后台登录"),o=r({}),t=r("");async function l(e,i){var s;const a=await d(e,i);return a.code===1&&(o.value=a.data.userInfo,localStorage.setItem("userInfo",JSON.stringify(o.value)),localStorage.setItem("token",((s=o.value)==null?void 0:s.token)||"")),a}async function c(){const e=await I();e.code===1&&(n.value=e.data.site_name)}async function u(){o.value=null,localStorage.removeItem("token"),await p();const e=localStorage.getItem("loginUrl")||"/";m.push(e)}return{site_name:n,userInfo:o,loginUrl:t,login:l,logout:u,getInfos:c}});export{y as u};
